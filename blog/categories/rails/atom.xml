<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Rails | Learning Ruby]]></title>
  <link href="http://ppj.github.io/blog/categories/rails/atom.xml" rel="self"/>
  <link href="http://ppj.github.io/"/>
  <updated>2014-10-22T16:49:18+11:00</updated>
  <id>http://ppj.github.io/</id>
  <author>
    <name><![CDATA[Prasanna Joshi]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[DRY Up Example With Modules and Gem Creation]]></title>
    <link href="http://ppj.github.io/blog/2014/10/21/dry-up-example-with-modules-and-gem-creation/"/>
    <updated>2014-10-21T16:42:46+11:00</updated>
    <id>http://ppj.github.io/blog/2014/10/21/dry-up-example-with-modules-and-gem-creation</id>
    <content type="html"><![CDATA[<p>Almost all the code enabling voting for the Posts and Comments in the PostIt app is common. Its original implementation screamed <strong>D</strong>on&#39;t <strong>R</strong>epeat <strong>Y</strong>ourself, or, in short <strong>DRY</strong>.</p>

<!-- more -->

<p>The same thing is true for the slug-generation and use functionality as well. The slug code is repeated for not two, but three models, namely Post, Category and User. DRYing up the slug code however represents one small challenge as compared to the voting code: slugs are generated from different attributes in each model, <code>:title</code> for Post, <code>:username</code> for User, and <code>:name</code> for Category.</p>

<p>This adds a degree of complexity to how the slug code can be DRYed, and that&#39;s why, this article uses slug as the example to explain the process. Voting DRYing up is not just similar, but much simpler.</p>

<ol>
<li><a name='modt'></a><a href="#mod">DRYing with Modules</a></li>
<li><a name='gemt'></a><a href="#gem">DRYing with Gems</a></li>
</ol>

<p><a name='mod'></a></p>

<h3 id="1.-&#39;dry&#39;ing-up-code-with-modules">1. &#39;DRY&#39;ing up code with Modules</h3>

<p>For the application to load modules from a common location (./lib), the following line needs to be added to ./config/application.rb under the Application class definition:
<code>config.autoload_paths += %W(#{config.root}/lib)</code></p>

<p>The above creates an array with application_root/lib path in a string format and adds it to the pre-existing array stored in <code>PostitTemplate::Application.config.autoload_paths</code>. This will ensure that all files stored in the ./lib folder will be automatically loaded at application startup.</p>

<p>Slugable.rb stored in this path will be populated by cutting the slug related code from any of the models that implements it (Post, Category, or User). In addition to that, the module file has a call to <code>extend ActiveSupport::Concern</code>. This enables some extra features like capability to add Class methods to the including class and the <code>included</code> hook to let some code to be executed only at the inclusion time. </p>

<p>Shown below is the above implemented for the slugging code, which is also repeated in the User, Post and Category models.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">module</span> <span class="nn">Slugable</span>
  <span class="kp">extend</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Concern</span>

  <span class="n">included</span> <span class="k">do</span>
    <span class="n">class_attribute</span> <span class="ss">:slug_column</span>
    <span class="n">before_save</span> <span class="ss">:generate_slug!</span>
  <span class="k">end</span>

  <span class="k">module</span> <span class="nn">ClassMethods</span>
    <span class="k">def</span> <span class="nf">set_slug_column_to</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
      <span class="nb">self</span><span class="o">.</span><span class="n">slug_column</span> <span class="o">=</span> <span class="n">column</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">to_param</span>
    <span class="nb">self</span><span class="o">.</span><span class="n">slug</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">generate_slug!</span>
    <span class="n">the_slug</span> <span class="o">=</span> <span class="n">to_slug</span><span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">slug_column</span><span class="p">))</span>
    <span class="n">model</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">to_s</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">record</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">find_by</span> <span class="ss">slug</span><span class="p">:</span> <span class="n">the_slug</span>
    <span class="k">while</span> <span class="n">record</span> <span class="ow">and</span> <span class="n">record</span> <span class="o">!=</span> <span class="nb">self</span>
      <span class="n">the_slug</span> <span class="o">=</span> <span class="n">make_unique</span><span class="p">(</span><span class="n">the_slug</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
      <span class="n">record</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">find_by</span> <span class="ss">slug</span><span class="p">:</span> <span class="n">the_slug</span>
      <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">end</span>

    <span class="nb">self</span><span class="o">.</span><span class="n">slug</span> <span class="o">=</span> <span class="n">the_slug</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">to_slug</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>                <span class="c1"># str=&quot; @#$@ My First @#2@%#@ Post!!  &quot;</span>
    <span class="n">str</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="n">strip</span>               <span class="c1">#  --&gt;&quot;@#$@ My First @#2@%#@ Post!!&quot;</span>
    <span class="n">str</span><span class="o">.</span><span class="n">gsub!</span><span class="p">(</span><span class="sr">/[^A-Za-z0-9]/</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="c1">#  --&gt;&quot;-----My-First---2-----Post--&quot;</span>
    <span class="n">str</span><span class="o">.</span><span class="n">gsub!</span><span class="p">(</span><span class="sr">/-+/</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>           <span class="c1">#  --&gt;&quot;-My-First-2-Post-&quot;</span>
    <span class="n">str</span><span class="o">.</span><span class="n">gsub!</span><span class="p">(</span><span class="sr">/^-+/</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>           <span class="c1">#  --&gt;&quot;My-First-2-Post-&quot;</span>
    <span class="n">str</span><span class="o">.</span><span class="n">gsub!</span><span class="p">(</span><span class="sr">/-+$/</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>           <span class="c1">#  --&gt;&quot;My-First-2-Post&quot;</span>
    <span class="n">str</span><span class="o">.</span><span class="n">downcase</span>                  <span class="c1">#  --&gt;&quot;my-first-2-post&quot;</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">make_unique</span><span class="p">(</span><span class="n">the_slug</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">the_slug</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">to_i</span> <span class="o">==</span> <span class="mi">0</span>
      <span class="n">the_slug</span> <span class="o">=</span> <span class="n">the_slug</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">count</span><span class="o">.</span><span class="n">to_s</span>
    <span class="k">else</span>
      <span class="n">the_slug</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">-</span><span class="mi">1</span><span class="o">].</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">count</span><span class="o">.</span><span class="n">to_s</span>
    <span class="k">end</span>
    <span class="n">the_slug</span>
  <span class="k">end</span>

<span class="k">end</span>
</code></pre></div>
<p>What makes the Slugable module more complex is the need to handle varying attribute names for the model. This has to be specified by the model including this module. This is implemented using the <code>class_attribute :slug_column</code> and the class method <code>set_slug_column_to(column)</code>. 
So, apart from the <code>include Slugable</code> call, the models have to call the <code>set_slug_column_to</code> and pass the appropriate <code>:attribute_name</code> to it.  </p>

<table><thead>
<tr>
<th>Model</th>
<th>should include this call</th>
</tr>
</thead><tbody>
<tr>
<td>User</td>
<td><code>set_slug_column_to :username</code></td>
</tr>
<tr>
<td>Post</td>
<td><code>set_slug_column_to :title</code></td>
</tr>
<tr>
<td>Category</td>
<td><code>set_slug_column_to :name</code></td>
</tr>
</tbody></table>

<p><a href="#modt">Back</a></p>

<p><a name='gem'></a></p>

<h3 id="2.-&#39;dry&#39;ing-up-code-with-gems">2. &#39;DRY&#39;ing up code with Gems</h3>

<p>Once we have the Slugable module, it is fairly easy to create a gem from it. But why create a gem when we have DRY code already? The main reason is usability across multiple Rails projects. It will also enable other developers to use (a.k.a. &#39;consume&#39;) the gem if it is pushed to <a href="http://rubygems.org/">RubyGems.org</a>.</p>

<p>Note: One prerequisite for creating a gem is having a gem called &#39;gemcutter&#39; installed. If you don&#39;t already have it (check using <code>gem list gemcutter</code>), install it by issuing <code>gem install gemcutter</code> in your shell.</p>

<p>Since the gem is going to be a separate project, we need to create a separate folder to hold its code. The following steps highlight the process to create the slug gem.</p>

<p>A &#39;Slugable.gemspec&#39; file needs to be in the root path of the gem folder and it should have the following code:<br>
<code>ruby ./slugable.gemspec
Gem::Specification.new do |s|
  s.name        = &quot;sluggit-ppj&quot;
  s.version     = &quot;0.0.0&quot;
  s.date        = &quot;2014-10-20&quot;
  s.summary     = &quot;A slug generator gem&quot;
  s.description = &quot;A cool gem for slugifying models.&quot;
  s.author      = &quot;Prasanna Joshi&quot;
  s.email       = &quot;author@myemail.com&quot;
  s.files       = [&quot;lib/slugable_ppj.rb&quot;]
  s.homepage    = &quot;http://www.github.com&quot;
end
</code></p>

<div>Some key settings:</div>

<ul>
<li><code>s.name</code>: specifies the name of the gem</li>
<li><code>s.files</code>: specifies where the code for the gem resides</li>
<li><code>s.version</code>: versioning mechanism for the gem</li>
</ul>

<p>The &#39;./lib/slugable_ppj.rb&#39; could be an exact replica of the module file created earlier.</p>

<p>This is all we need to <strong>create our gem</strong>. Issue<br>
<code>gem build slugable.gemspec</code><br>
<div>from the gem root folder path at the shell prompt. If successful in creating the gem, you should see the following output from the command:</div>
<code>
  ~/sluggable-gem&gt; gem build slugable.gemspec
    Successfully built RubyGem
    Name: sluggit-ppj
    Version: 0.0.0
    File: sluggit-ppj-0.0.0.gem
</code>
You can see that the &#39;sluggit-ppj-0.0.0.gem&#39; file has been created in you gem root path.</p>

<div>Once created, we need to follow the steps below to actually <strong>use</strong> it now in our project:</div>

<ol>
<li>add the following lines in the Gemfile of your project to make it available:
<code>gem &#39;sluggit-ppj&#39;, path: &#39;% local_root_path_of_the_gem %&#39;</code></li>
<li>run <code>bundle install</code> after modifying the Gemfile</li>
<li>add <code>require slugable_ppj</code> before the features of the gem are called in your code (safest place to add it in is the file &#39;projec_root_path/config/application.rb&#39; because this file gets loaded immediately after the application starts)</li>
</ol>

<p>Once you have the gem working like you want to, you can push it to RubyGems.org using the &#39;gemcutter&#39; command:<br>
<code>gem push sluggit-ppj-0.0.0.gem</code><br>
The &#39;.gem&#39; file version should change based on your changes to the <code>s.version</code> setting in the &#39;.gemspec&#39; file.</p>

<p>Note: The gem can be disabled (at RubyGems.org) by issuing the 
<code>gem yank sluggit-ppj -v &#39;0.0.0&#39;</code><br>
command from the gem root path in the shell. As you can see, you can <code>yank</code> a particular version of the gem from RubyGems.org.</p>

<p><a href="#gemt">Back</a></p>

<div id="disqus_thread"></div>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ppjgithubio'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<p><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Enhancements to the PostIt App]]></title>
    <link href="http://ppj.github.io/blog/2014/10/21/enhancements-to-the-postit-app/"/>
    <updated>2014-10-21T16:16:17+11:00</updated>
    <id>http://ppj.github.io/blog/2014/10/21/enhancements-to-the-postit-app</id>
    <content type="html"><![CDATA[<p>The final lesson (Lesson 4) of Course 2 involved adding some more functionality to the <a href="ppj-postit.heroku.com">PostIt</a> app (the Reddit clone).</p>

<!-- more -->

<ol>
<li><a name='ajaxt'></a><a href="#ajax">&#39;AJAX&#39;ifying voting</a></li>
<li><a name='slugt'></a><a href="#slug">&#39;Slug&#39;ifying routes</a></li>
<li><a name='rolet'></a><a href="#role">Simple Role Implementation</a></li>
<li><a name='timet'></a><a href="#time">Time-zone Setting</a></li>
</ol>

<p><a name='ajax'></a></p>

<h3 id="1.-&#39;ajax&#39;ifying-the-voting">1. &#39;AJAX&#39;ifying the voting</h3>

<p>In Rails, this is slightly different from the way this is implemented in a non-Rails based web application. Called Server-generated JavaScript Response (SJR), Rails can dynamically create a JavaScript that implements an AJAX action.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">link_to</span> <span class="n">vote_post_path</span><span class="p">(</span><span class="n">post_object</span><span class="p">,</span> <span class="ss">vote</span><span class="p">:</span> <span class="n">value</span><span class="p">),</span> <span class="nb">method</span><span class="p">:</span> <span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="ss">remote</span><span class="p">:</span> <span class="kp">true</span> <span class="k">do</span>
  <span class="n">icon</span><span class="o">.</span><span class="n">html_safe</span>
<span class="k">end</span>
</code></pre></div>
<p>The <code>remote: true</code> switch dictates AJAX implementation of that particular link. </p>

<p>Another thing to note is that the <code>method: &#39;post&#39;</code> switch dynamically (using a JavaScript) injects a form with &#39;POST&#39; submission to the same link as indicated by the <code>vote_post_path(post_object)</code> call.</p>

<p>The action that handles the new request needs to be modified to deal with a JavaScript response now:
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>    <span class="nb">format</span><span class="o">.</span><span class="n">html</span> <span class="k">do</span>
</span><span class='line'>      <span class="k">if</span> <span class="vi">@vote</span><span class="o">.</span><span class="n">valid?</span>
</span><span class='line'>        <span class="n">flash</span><span class="o">[</span><span class="ss">:notice</span><span class="o">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#39;Your vote was cast.&amp;#39;</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="n">flash</span><span class="o">[</span><span class="ss">:error</span><span class="o">]</span>  <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#39;You can vote only once on this post.&amp;#39;</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="n">redirect_to</span> <span class="ss">:back</span>
</span><span class='line'>    <span class="k">end</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;format.js # by default renders the [action_name].js.erb template in the views/</span><span class="o">[</span><span class="n">controller_name</span><span class="o">]</span> <span class="n">folder</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>The code in the [action_name].js.erb could be something as simple as:
<code>$(&#39;#post_&lt;%= @post.id %&gt;_votebox&#39;).html(&quot;&lt;%= @post.total_votes %&gt;&quot;);</code>
or a bit more complicated as in <a href="https://github.com/ppj/postit/blob/master/app/views/posts/vote.js.erb">this file</a></p>

<div>Refer to these commits to the PostIt app for details of code changes:</div>

<ul>
<li><a href="https://github.com/ppj/postit/commit/d2a716df3e0730fda75255fbd9c65e721704be7d">AJAXified voting for posts</a></li>
<li><a href="https://github.com/ppj/postit/commit/2ae2aa22ed08058227d07463d348cf51e27354c1">AJAXified voting for comments</a></li>
</ul>

<p><a href="#ajaxt">Back</a></p>

<p><a name='slug'></a></p>

<h3 id="2.-&#39;slug&#39;ifying-the-routes">2. &#39;Slug&#39;ifying the routes</h3>

<p>There is a security concern with URLs that look like &#39;ppj-postit.heroku.com/users/3&#39; with the &#39;3&#39; representing the ID of the User object. Same is the case with Posts and Categories. A more appropriate URL for the above would be &#39;ppj-postit.heroku.com/users/testman&#39; where &#39;testman&#39; is automatically generated from the <code>username</code> attribute of a user. This is what is called a &#39;slug&#39; in web development jargon. To achieve this, the <code>to_param()</code> method of the model object has to be over-ridden, because this is the method used by the named-route methods like <code>user_path</code>, et al.</p>

<p>First a &#39;slug&#39; column needs to be added to the models (tables) to store the respective slugs. The models also need to have a way to automatically generate and save the slug. The former can be done by simple column creating migration. The generation of the slug can also be done in the same migration (for existing records). The slug-generator will take the appropriate attribute of the model, the <code>:username</code> attribute in case of the Users table. </p>

<p>Writing a <code>generate_slug</code> method for the model will be useful for auto-generation of slugs. This method can then be called to create a slug every time a new User object is created using the <code>before_save</code> <a href="http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html">ActiveRecord callback</a>.</p>

<div>These modifications to the User model show a simple implementation of the above technique:</div>

<p><figure class='code'><figcaption><span>./app/models/user.rb </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="k">class</span> <span class="nc">User</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">before_save</span> <span class="ss">:generate_slug</span>
</span><span class='line'>  <span class="o">.</span>
</span><span class='line'>  <span class="c1"># rest of the code omitted for brevity</span>
</span><span class='line'>  <span class="o">.</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">generate_slug</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">slug</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">username</span>
</span><span class='line'>  <span class="k">end</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;def to_param</span>
</span><span class='line'><span class="sr">    self.slug # overrides the default self.id</span>
</span><span class='line'><span class="sr">  end&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>
<div>The URL will now have the value of the <code>:username</code> attribute and so the view templates now need to search the User object by slug instead of ID:</div>
<code>diff
   def set_user
-    @user = User.find(params[:id])
+    @user = User.find_by(slug: params[:id])
   end
</code></p>

<p>Note: The implementation of <code>generate_slug</code> shown above is very simplistic. A robust implementation should ensure that the slugs are never repeated for the same model. This is especially applicable for the models where slugs will be generated from a non-unique attribute (e.g. Posts.title). The code below shows exactly that:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby">  <span class="k">def</span> <span class="nf">generate_slug!</span>
    <span class="n">the_slug</span> <span class="o">=</span> <span class="n">to_slug</span><span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">record</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">find_by</span> <span class="ss">slug</span><span class="p">:</span> <span class="n">the_slug</span>
    <span class="k">while</span> <span class="n">record</span> <span class="ow">and</span> <span class="n">record</span> <span class="o">!=</span> <span class="nb">self</span>
      <span class="n">the_slug</span> <span class="o">=</span> <span class="n">make_unique</span><span class="p">(</span><span class="n">the_slug</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
      <span class="n">record</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">find_by</span> <span class="ss">slug</span><span class="p">:</span> <span class="n">the_slug</span>
      <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">end</span>

    <span class="nb">self</span><span class="o">.</span><span class="n">slug</span> <span class="o">=</span> <span class="n">the_slug</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">to_slug</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>                <span class="c1"># str=&quot; @#$@ My First @#2@%#@ Post!!  &quot;</span>
    <span class="n">str</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="n">strip</span>               <span class="c1">#  --&gt;&quot;@#$@ My First @#2@%#@ Post!!&quot;</span>
    <span class="n">str</span><span class="o">.</span><span class="n">gsub!</span><span class="p">(</span><span class="sr">/[^A-Za-z0-9]/</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="c1">#  --&gt;&quot;-----My-First---2-----Post--&quot;</span>
    <span class="n">str</span><span class="o">.</span><span class="n">gsub!</span><span class="p">(</span><span class="sr">/-+/</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>           <span class="c1">#  --&gt;&quot;-My-First-2-Post-&quot;</span>
    <span class="n">str</span><span class="o">.</span><span class="n">gsub!</span><span class="p">(</span><span class="sr">/^-+/</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>           <span class="c1">#  --&gt;&quot;My-First-2-Post-&quot;</span>
    <span class="n">str</span><span class="o">.</span><span class="n">gsub!</span><span class="p">(</span><span class="sr">/-+$/</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>           <span class="c1">#  --&gt;&quot;My-First-2-Post&quot;</span>
    <span class="n">str</span><span class="o">.</span><span class="n">downcase</span>                  <span class="c1">#  --&gt;&quot;my-first-2-post&quot;</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">make_unique</span><span class="p">(</span><span class="n">the_slug</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">the_slug</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">to_i</span> <span class="o">==</span> <span class="mi">0</span>
      <span class="n">the_slug</span> <span class="o">=</span> <span class="n">the_slug</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">count</span><span class="o">.</span><span class="n">to_s</span>
    <span class="k">else</span>
      <span class="n">the_slug</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">-</span><span class="mi">1</span><span class="o">].</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">count</span><span class="o">.</span><span class="n">to_s</span>
    <span class="k">end</span>
    <span class="n">the_slug</span>
  <span class="k">end</span>
</code></pre></div>
<div>Refer to these commits to the PostIt app for details of code changes:</div>

<ul>
<li><a href="https://github.com/ppj/postit/commit/64e1e4eb49f1485c8684e01b67bac6a6a64d327b">Slugifying the Post model</a></li>
<li><a href="https://github.com/ppj/postit/commit/715a2d8a2ba415d048bc776c09c0d4438757201f">Robust slug generation algorithm</a></li>
</ul>

<p><a href="#slugt">Back</a></p>

<p><a name='role'></a></p>

<h3 id="3.-simple-role-implementation">3. Simple Role Implementation</h3>

<div>A very common requirement for an app that user-authentication is a need to differentiate between users on the basis of permissions they have. A simple way to enable roles for users:</div>

<ol>
<li>add a &#39;role&#39; columns to the Users table using a simple migration</li>
<li><div>add methods to the model to check whether a particular user has a specific role (indicated by a string in the role column)</div>
<code>ruby
def admin?
  self.role == &#39;admin&#39;
end
</code></li>
<li><div>enable/disable features in the controllers&#8230;
<code>ruby application_controller.rb  
def require_admin
  access_denied &quot;You need admin access to do that!&quot; unless logged_in? and current_user.admin?
end
</code>
or in the view templates&#8230;
<code>ruby
&lt;% if logged_in? and current_user.admin? %&gt;
&lt;li&gt;&lt;%= link_to &quot;Create New Category&quot;, new_category_path %&gt;&lt;/li&gt;
&lt;% end %&gt;
</code>
based on the role checks</div></li>
</ol>

<p>A more serious implementation would call for defining a Role model and a Permission model. A has-many through associations will define Users can have many Roles <code>through: :permissions</code>. The role checks can now be done through this association. Chris Lee, the instructor of the 2nd course suggests that this should be avoided unless absolutely necessary, because this rolls into a massive net of checks and nested models. The simple implementation shown above suffices our need.</p>

<div>Refer to these commits to the PostIt app for details of code changes:</div>

<ul>
<li><a href="https://github.com/ppj/postit/commit/2f43e69028a34f13585328db7993de34401dbc96">Adding role to User table</a></li>
<li><a href="https://github.com/ppj/postit/commit/4e04e1f03d592ac5bd06d5b0374411dd7ba6a48f">Only &#39;admin&#39;s can create categories</a></li>
<li><a href="https://github.com/ppj/postit/commit/39c5a1a6c9725069ba5e51e2f727f5cee99f7c5e">Only author or admins can edit a post</a></li>
</ul>

<p><a href="#rolet">Back</a></p>

<p><a name='time'></a></p>

<h3 id="4.-time-zone-setting">4. Time-zone Setting</h3>

<p>The app has a default time-zone (UTC) which can be overridden by specifying a different one in the &#39;./config/application.rb&#39; file.<br>
Adding <code>config.time_zone = &#39;Melbourne&#39;</code> to this file will set the default time-zone of the application to Melbourne time overriding the default (UTC)</p>

<p>Note: All available time-zones can be listed by running the rake task <code>rake time:zones:all</code>.  </p>

<p>Now that the application has a default time-zone, each user should be able to set his/her own. That would need a dedicated column to save that user&#39;s &#39;timezone&#39; in. This can be added by a simple migration:</p>

<ol>
<li><code>rails generate migration add_timezone_to_users</code><br></li>
<li><div>Add time-zone column to the User table:</div>
<code>ruby
class AddTimezoneToUsers &lt; ActiveRecord::Migration
def change
add_column :users, :timezone, :string
end
end
</code></li>
<li><code>rake db:migrate</code></li>
</ol>

<p>Time to modify the view template to allow setting of the time-zone: the common form partial used for User registration (User#new) and profile-update (User#edit). The following addition to the existing form partial will address this need:<br>
<code>
  &lt;div class=&#39;control-group&#39;&gt;
    &lt;%= f.label :timezone %&gt;
    &lt;%= f.time_zone_select :timezone, nil, default: Time.zone.name %&gt;
  &lt;/div&gt;
</code></p>

<p>The strong parameters need to include the new attribute <code>:timezone</code> for the above to work through the web interface.<br>
<code>params.require(:user).permit(:username, :password, :timezone)</code></p>

<p>For time to be displayed in the logged in user&#39;s time-zone, the time-display helper now needs to be modified:</p>
<div class="highlight"><pre><code class="language-diff" data-lang="diff">   def fix_time(time)
<span class="gd">-    time.localtime.strftime(&quot;(%d-%b-%Y %I:%M%p %Z)&quot;)</span>
<span class="gi">+    if logged_in?</span>
<span class="gi">+      time = time.in_time_zone(current_user.timezone)</span>
<span class="gi">+    end</span>
<span class="gi">+    time.strftime(&quot;(%d-%b-%Y %I:%M%p %Z)&quot;)</span>
   end
</code></pre></div>
<p>Refer to <a href="https://github.com/ppj/postit/commit/82c43c1a65aebfafc830b6d7cf361636689ba6b6">this commit</a> to the PostIt app for details of code changes.  </p>

<p><a href="#timet">Back</a></p>

<div id="disqus_thread"></div>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ppjgithubio'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<p><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Some Additional Features for the PostIt App]]></title>
    <link href="http://ppj.github.io/blog/2014/10/13/some-additional-features-for-the-postit-app/"/>
    <updated>2014-10-13T14:30:40+11:00</updated>
    <id>http://ppj.github.io/blog/2014/10/13/some-additional-features-for-the-postit-app</id>
    <content type="html"><![CDATA[<p>Almost at the end of <a href="/2014/10/12/quiz-for-rails-beginners-3/">Lesson 3</a>, i decided to add a couple of additional features to my <a href="http://ppj-postit.herokuapp.com/">PostIt</a> web application i am developing as a part of the <a href="http://www.gotealeaf.com/curriculum#!rails">second course</a> at <a href="http://www.gotealeaf.com/">Tealeaf Academy</a></p>

<!-- more -->

<p>Here are the two features i have attempted to add:</p>

<ol>
<li><a href="#new_category">Creation Of A New Category On The Go</a></li>
<li><a href="#vote_deletion">Deletion Of A Vote</a></li>
</ol>

<p><a name='new_category'></a></p>

<h3 id="create-a-new-category-on-the-go">Create A New Category On The Go</h3>

<p>In the default application (as instructed in the course), the only way to create a new category was through the Categories dropdown button in the navigation bar as show in the image below:</p>

<p><center><img src="/images/dropdown_new_category.jpg" alt="Add new category"></center></p>

<p>This is not very helpful when a user would want to add a new category during creation of a new post. So, i added a new category creation form inside the Posts-new view template. But that meant making sure the validation on the category name fired from here without destroying the new post contents. This also necessitated the use of non-model backed form helpers (although Category is a model, the text-field to pass new category name is not in a Category model-backed form).</p>

<p>This helper in the Posts controller class helps to determine whether to create a new category or not:
<figure class='code'><figcaption><span>posts_controller.rb : create_new_category</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="k">def</span> <span class="nf">create_new_category</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;if params[:new_category].strip.empty?</span>
</span><span class='line'><span class="sr">    false</span>
</span><span class='line'><span class="sr">  else</span>
</span><span class='line'><span class="sr">    category_names = Category.all.map(&amp;amp;:name)</span>
</span><span class='line'><span class="sr">    index = category_names.index(params[:new_category])</span>
</span><span class='line'><span class="sr">    if index</span>
</span><span class='line'><span class="sr">      @category = Category.find_by(name: category_names[index])</span>
</span><span class='line'><span class="sr">      @category.id</span>
</span><span class='line'><span class="sr">    else</span>
</span><span class='line'><span class="sr">      @category = Category.new(name: params[:new_category])</span>
</span><span class='line'><span class="sr">      if @category.save</span>
</span><span class='line'><span class="sr">        @category.id</span>
</span><span class='line'><span class="sr">      else</span>
</span><span class='line'><span class="sr">        false</span>
</span><span class='line'><span class="sr">      end</span>
</span><span class='line'><span class="sr">    end</span>
</span><span class='line'><span class="sr">  end&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>The following code in the Posts#create uses the above helper:
<figure class='code'><figcaption><span>posts_controller.rb : create</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="n">category_index</span> <span class="o">=</span> <span class="n">create_new_category</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;if category_index</span>
</span><span class='line'><span class="sr">  flash[:notice] = &amp;quot;Category &amp;amp; Post created successfully!&amp;quot;</span>
</span><span class='line'><span class="sr">  category_check_passed = true</span>
</span><span class='line'><span class="sr">elsif @category</span>
</span><span class='line'><span class="sr">  category_check_passed = @category.errors.empty?</span>
</span><span class='line'><span class="sr">else</span>
</span><span class='line'><span class="sr">  category_check_passed = true</span>
</span><span class='line'><span class="sr">end&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="k">if</span> <span class="vi">@post</span><span class="o">.</span><span class="n">save</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">category_check_passed</span>
</span><span class='line'>  <span class="vi">@post</span><span class="o">.</span><span class="n">categories</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="vi">@category</span> <span class="k">if</span> <span class="n">category_index</span>
</span><span class='line'>  <span class="n">flash</span><span class="o">[</span><span class="ss">:notice</span><span class="o">]</span> <span class="o">||=</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="no">Post</span> <span class="n">created</span> <span class="n">successfully!</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span>
</span><span class='line'>  <span class="n">redirect_to</span> <span class="n">posts_path</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'>  <span class="vi">@new_category</span> <span class="o">=</span> <span class="n">params</span><span class="o">[</span><span class="ss">:new_category</span><span class="o">]</span>
</span><span class='line'>  <span class="n">render</span> <span class="ss">:new</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>It is used in a similar way in the Posts#update action.</p>

<p>Here&#39;s how it looks in the create-new-post form now:
<center><img src="/images/new_category_blank.JPG" alt="New Category Blank"></center></p>

<p>If, new category creation fails:
<center><img src="/images/new_category_error.JPG" alt="New Category Error"></center></p>

<p>Here&#39;s the post after the validation passes:
<center><img src="/images/new_category_success.JPG" alt="New Category Success"></center></p>

<p>The changes in the form partial are highlighted in the git-diff below:
<code>diff views/posts/\_form.html.erb
 &lt;div class=&#39;well&#39;&gt;
   &lt;%= render &#39;shared/errors&#39;, model_obj: @post %&gt;
   &lt;%= form_for @post do |f| %&gt;
     &lt;div class=&#39;control-group&#39;&gt;
       &lt;%= f.label :title %&gt;
       &lt;%= f.text_field :title %&gt;
     &lt;/div&gt;
     &lt;div class=&#39;control-group&#39;&gt;
       &lt;%= f.label :url %&gt;
       &lt;%= f.text_field :url %&gt;
     &lt;/div&gt;
     &lt;div class=&#39;control-group&#39;&gt;
       &lt;%= f.label :description %&gt;
       &lt;%= f.text_area :description, rows: 4 %&gt;
     &lt;/div&gt;
     &lt;br/&gt;
     &lt;div class=&#39;control-group&#39;&gt;
       &lt;%= f.label :category_ids, &quot;Categories&quot; %&gt;
       &lt;%= f.collection_check_boxes :category_ids, Category.all, :id, :name do |b| %&gt;
         &lt;% b.label(class: &quot;checkbox inline&quot;) { b.check_box(class: &quot;checkbox inline&quot;) + b.text } %&gt;
       &lt;% end %&gt;
+      &lt;%= render(&#39;shared/errors&#39;, model_obj: @category) if @category %&gt;
+      &lt;% new_category = @new_category ? @new_category : &quot;&quot; %&gt;
+      &lt;%= label_tag :new_category, &quot;Create a new category: &quot; %&gt;
+      &lt;%= text_field_tag :new_category, new_category %&gt;
     &lt;/div&gt;
     &lt;%= f.submit class: &#39;btn btn-primary&#39;%&gt;
   &lt;% end %&gt;
 &lt;/div&gt;
</code></p>

<p><a name='vote_deletion'></a></p>

<h3 id="deletion-of-a-vote">Deletion Of A Vote</h3>

<p>One user cannot vote more than once on a post or a comment through this validation in the Votes model:<br>
<code>validates_uniqueness_of :creator, scope: [:voteable_type, :voteable_id]</code></p>

<div>What if a user voted by mistake or changed his/her mind on a particular post or comment? Adding this capability meant that I needed to do primarily two things:</div>  

<ul>
<li>If the logged in user has voted (up or down) on a particular item, show an icon to delete the vote instead of an icon to cast a vote (the thumbs-up or thumbs-down icon)<br></li>
<li>The vote deletion icon should call an action to delete this user&#39;s vote on that item</li>
</ul>

<p>I added these by writing one helper method for each &#39;voteable&#39; model, comment, and post. Shown below is the one for comment (the more complex of the two). The one for post is very similar.
<figure class='code'><figcaption><span>/app/helpers/application_helper.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="k">module</span> <span class="nn">ApplicationHelper</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;def link_based_on_current_users_vote_on_comment(comment_object, value)</span>
</span><span class='line'><span class="sr">    if Vote.find_by(creator: current_user, vote: value, voteable: comment_object)</span>
</span><span class='line'><span class="sr">      link_to vote_destroy_post_comment_path(comment_object.post, comment_object), method: &amp;#39;delete&amp;#39; do</span>
</span><span class='line'><span class="sr">        &amp;quot;&lt;i class=&#39;icon-fire&#39;&gt;&lt;/i</span><span class="o">&gt;&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">.</span><span class="n">html_safe</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="n">icon</span> <span class="o">=</span> <span class="n">value</span> <span class="p">?</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&lt;</span><span class="n">i</span> <span class="n">class</span><span class="o">=</span><span class="s1">&#39;icon-thumbs-up&#39;</span><span class="o">&gt;&lt;</span><span class="sr">/i&gt;&amp;quot; : &amp;quot;&lt;i class=&#39;icon-thumbs-down&#39;&gt;&lt;/i</span><span class="o">&gt;&amp;</span><span class="n">quot</span><span class="p">;</span>
</span><span class='line'>      <span class="n">link_to</span> <span class="n">vote_post_comment_path</span><span class="p">(</span><span class="n">comment_object</span><span class="o">.</span><span class="n">post</span><span class="p">,</span> <span class="n">comment_object</span><span class="p">,</span> <span class="ss">vote</span><span class="p">:</span> <span class="n">value</span><span class="p">),</span> <span class="nb">method</span><span class="p">:</span> <span class="o">&amp;</span><span class="c1">#39;post&amp;#39; do</span>
</span><span class='line'>        <span class="n">icon</span><span class="o">.</span><span class="n">html_safe</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;end&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;highlight&quot;</span><span class="o">&gt;&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;language-text&quot;</span> <span class="n">data</span><span class="o">-</span><span class="n">lang</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="o">&gt;</span><span class="no">Using</span> <span class="n">this</span> <span class="n">helper</span> <span class="nb">method</span> <span class="k">in</span> <span class="n">the</span> <span class="n">view</span> <span class="n">template</span> <span class="n">is</span> <span class="n">illustrated</span> <span class="ss">below</span><span class="p">:</span>
</span></code></pre></td></tr></table></div></figure> Ruby \_comments.html.erb
  &lt;% if logged_in? %&gt;
    &lt;%= link_based_on_current_users_vote_on_comment(comment, true) %&gt;
    &lt;br&gt;
  &lt;% end %&gt;
  &lt;%= &quot;&lt;strong&gt;#{comment.vote_count}&lt;/strong&gt; &lt;small&gt;(#{pluralize(comment.votes.size, &quot;Vote&quot;)})&lt;/small&gt;&quot;.html_safe %&gt;
  &lt;% if logged_in? %&gt;
    &lt;br&gt;
    &lt;%= link_based_on_current_users_vote_on_comment(comment, false) %&gt;
  &lt;% end %&gt;
</code></pre></div>
<p>The images below show the conditional rendering:</p>

<table><thead>
<tr>
<th style="text-align: center">When user has not voted on the item</th>
<th style="text-align: center">When the user has voted &#39;up&#39; an item</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center"><img src="/images/Votes_no_delete.JPG" alt="Vote Box No Delete"></td>
<td style="text-align: center"><img src="/images/Votes_with_delete.JPG" alt="Vote Box No Delete"></td>
</tr>
</tbody></table>

<div id="disqus_thread"></div>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ppjgithubio'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<p><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Quiz for Rails Beginners 3]]></title>
    <link href="http://ppj.github.io/blog/2014/10/12/quiz-for-rails-beginners-3/"/>
    <updated>2014-10-12T16:22:01+11:00</updated>
    <id>http://ppj.github.io/blog/2014/10/12/quiz-for-rails-beginners-3</id>
    <content type="html"><![CDATA[<p>Here&#39;s the third quiz for people who are just getting started learning web-application development. 
This revisits the basics of MVC, implementing basic user-authentication and polymorphic associations.</p>

<!-- more -->

<ol>
<li><p><a name='q1'></a><a href="#a1">What&#39;s the difference between rendering and redirecting? What&#39;s the impact with regards to instance variables, view templates?</a></p></li>
<li><p><a name='q2'></a><a href="#a2">If I need to display a message on the view template, and I&#39;m redirecting, what&#39;s the easiest way to accomplish this?</a></p></li>
<li><p><a name='q3'></a><a href="#a3">If I need to display a message on the view template, and I&#39;m rendering, what&#39;s the easiest way to accomplish this?</a></p></li>
<li><p><a name='q4'></a><a href="#a4">Explain how we should save passwords to the database.</a></p></li>
<li><p><a name='q5'></a><a href="#a5">What should we do if we have a method that is used in both controllers and views?</a></p></li>
<li><p><a name='q6'></a><a href="#a6">What is memoization? How is it a performance optimization?</a></p></li>
<li><p><a name='q7'></a><a href="#a7">If we want to prevent unauthenticated users from creating a new comment on a post, what should we do?</a></p></li>
<li><p><a name='q8'></a><a href="#a8">Suppose we have the following table for tracking &quot;likes&quot; in our application. How can we make this table polymorphic? Note that the &quot;user_id&quot; foreign key is tracking who created the like.</a>  </p>

<table><thead>
<tr>
<th style="text-align: right">id</th>
<th style="text-align: center">user_id</th>
<th style="text-align: center">photo_id</th>
<th style="text-align: center">video_id</th>
<th style="text-align: center">post_id</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right">1</td>
<td style="text-align: center">4</td>
<td style="text-align: center"></td>
<td style="text-align: center">12</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: right">2</td>
<td style="text-align: center">7</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center">3</td>
</tr>
<tr>
<td style="text-align: right">3</td>
<td style="text-align: center">2</td>
<td style="text-align: center">6</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
</tbody></table></li>
<li><p><a name='q9'></a><a href="#a9">How do we set up polymorphic associations at the model layer? Give example for the polymorphic model (eg, Vote) as well as an example parent model (the model on the 1 side, eg, Post).</a></p></li>
<li><p><a name='q10'></a><a href="#a10">What is an ERD diagram, and why do we need it?</a></p></li>
</ol>

<h3 id="my-answers:">MY ANSWERS:</h3>

<p><a name='a1'></a>
<strong>A1</strong>: Rendering a view template happens as (the final) part of a single HTTP request, whereas redirecting means end of a request and initiation a whole new request. And because of that, redirecting would not enable use of instance variables in the view templates unlike direct rendering.<br>
<a href="#q1">Back</a></p>

<p><a name='a2'></a>
<strong>A2</strong>: Using a hash referenced in the layout would be the easiest way to display messages if redirecting. For example:<br>
<code>flash[:notice] = &#39;You have successfully updated the profile&#39;</code>
<code>flash[:error] = &#39;The login credentials you entered are incorrect&#39;</code><br>
<a href="#q2">Back</a></p>

<p><a name='a3'></a>
<strong>A3</strong>: For generic messages, using the same hash as described in <a href="#a2">A2</a> above would work. If error messages on a model-object stored in an instance variable need to be displayed, that instance variable can be used directly in the view template using something like<br>
<code>ruby
&lt;% if model_obj.errors.any? %&gt;
  &lt;div class=&#39;row&#39;&gt;
    &lt;div class=&#39;alert alert-error span8&#39;&gt;
      &lt;h5&gt;Please fix the errors below to submit successfully:&lt;/h5&gt;
      &lt;ol&gt;
        &lt;% model_obj.errors.full_messages.each do |msg| %&gt;
          &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;
        &lt;% end %&gt;
      &lt;/ol&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;% end %&gt;
</code>
<a href="#q3">Back</a></p>

<p><a name='a4'></a>
<strong>A4</strong>: Passwords should definitely never be stored directly as strings in the database. They should be auto converted to complex strings (obfuscated) using a dedicated gem (like <strong>bcrypt-ruby</strong>). Such a gem can help obfuscate the user-entered password using the same mechanism to obfuscate the originally set password. Thus the comparison between the user entered and originally set password can happen indirectly through the obfuscated strings. This obfuscation is one-way, that means the stored string cannot be converted back to the actual password string.
In case of the bcrypt-ruby gem, the database table for the model needs to have a column named &#39;password_digest&#39; that can hold a string. The model itself needs to have the <code>has_secure_password</code> validation declared in its class-definition. bcrypt-ruby gives a method named <code>authenticate</code> for the model-object which can be used to match the user-entered password to the stored one.<br>
<a href="#q4">Back</a></p>

<p><a name='a5'></a>
<strong>A5</strong>: If a helper method defined in the ApplicationController class (which each of the controllers inherit from) needs to be used by both the views, and the controllers, the <code>helper_method</code> needs to be called in the ApplicationController class definition with the helper-method names passed to it as arguments (as <code>:symbol</code>s). So, a line like the one below in the ApplicationController class definition<br>
<code>helper_method :current_user, :logged_in?</code><br>
will allow the methods <code>current_user</code> and <code>logged_in?</code> to be used in both views and controllers. Note that a call to <code>helper_method</code> is not necessary if these only need to be used in the controllers.<br>
<a href="#q5">Back</a></p>

<p><a name='a6'></a>
<strong>A6</strong>: &#39;Memoization&#39; (a play on the word &#39;memoir&#39;) is an optimization technique used to speed up computer programs by storing the results of expensive function calls and returning the cached result when the same operation is requested repeatedly.<br>
It can be implemented in Ruby using the operator <code>||=</code> to assign a value to an instance variable. This can be used effectively to store results from a repeated database query (which can be quite performance intensive). The statement below is &#39;memoization&#39; in action:<br>
<code>@current_user ||= User.find(session[:user_id]) if session[:user_id]</code><br>
If the <code>current_user</code> instance variable is already populated (say, from a previous call to this statement), the cached result will be returned and evaluation of the right side of the above expression will be avoided.<br>
<a href="#q6">Back</a></p>

<p><a name='a7'></a>
<strong>A7</strong>: The rendering and submission of new comment form (Comments#new and Comments#create actions) should be allowed only if a user is logged in. This can be achieved by a common helper method that checks whether a valid user is logged in. This method will be defined in the parent controller class ApplicationController. This method can be called in the Comments controller class using the <code>before_action</code> keyword which will trigger checking of a valid user before executing certain actions.
<code>before_action :logged_in?, only: [:new, :create]</code><br>
<a href="#q7">Back</a></p>

<p><a name='a8'></a>
<div class='no_extra_new_line'><strong>A8</strong>: The table below shows the polymorphic version of the one shown in the question:</div>
<table style='margin-left:2em'>
  <thead>
    <tr>
      <th style="text-align: right">id</th>
      <th style="text-align: center">user_id</th>
      <th style="text-align: center">likeable_type</th>
      <th style="text-align: center">likeable_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">1</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">Video</td>
      <td style="text-align: center">12</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td style="text-align: center">7</td>
      <td style="text-align: center">Post</td>
      <td style="text-align: center">3</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">Photo</td>
      <td style="text-align: center">6</td>
    </tr>
  </tbody>
</table><br>
<a href="#q8">Back</a></p>

<p><a name='a9'></a>
<div class='no_extra_new_line'><strong>A9</strong>: The &#39;like&#39; model would look like this</div>
<code>Ruby like.rb
class Like &lt; ActiveRecord::Base
  belongs_to :user
  belongs_to :likeable, polymorphic: true
end
</code>
The User model (creator of the &#39;like&#39;s) will look like this<br>
<code>Ruby User.rb
class User &lt; ActiveRecord::Base
  has_many :photos
  has_many :videos
  has_many :posts
  has_many :likes
end
</code>
Finally, the &#39;likeable&#39;s: Photo, Video and Post models, are shown below<br>
<code>Ruby photo.rb
class Photo &lt; ActiveRecord::Base
  belongs_to :poster, foreign_key: &#39;user_id&#39;, class_name: &#39;User&#39;
  has_many :likes, as: :likeable
end
</code>
<code>Ruby video.rb
class Video &lt; ActiveRecord::Base
  belongs_to :poster, foreign_key: &#39;user_id&#39;, class_name: &#39;User&#39;
  has_many :likes, as: :likeable
end
</code>
<code>Ruby post.rb
class Post &lt; ActiveRecord::Base
  belongs_to :poster, foreign_key: &#39;user_id&#39;, class_name: &#39;User&#39;
  has_many :likes, as: :likeable
end
</code>
<a href="#q9">Back</a></p>

<p><a name='a10'></a>
<strong>A10</strong>: Entity Relationship Diagrams show individual ActiveRecord models and their association with each other. Individual models are represented as blocks and also show the columns that model&#39;s database table needs to have. These are really handy when we are setting up the database models and associations between them.<br>
See the ERD below for the PostIt application (Courtesy - Tealeaf Academy):
<img src="http://d3ncao0pifc37i.cloudfront.net/images/ERD_final.jpg" alt="Final ERD"><br>
<a href="#q10">Back</a></p>

<div id="disqus_thread"></div>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ppjgithubio'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<p><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Quiz for Rails Beginners 2]]></title>
    <link href="http://ppj.github.io/blog/2014/10/06/quiz-for-rails-beginners-2/"/>
    <updated>2014-10-06T13:49:13+11:00</updated>
    <id>http://ppj.github.io/blog/2014/10/06/quiz-for-rails-beginners-2</id>
    <content type="html"><![CDATA[<p>Here&#39;s the second quiz for people who are just getting started learning web-application development. This focuses more on the resources routes and related concepts in Rails.</p>

<!-- more -->

<p>Each question is a link pointing to my corresponding answer as i understand the concepts the today.</p>

<ol>
<li><p><a name='q1'></a><a href="#a1">Name all the 7 (or 8) routes exposed by the <code>resources</code> keyword in the <code>routes.rb</code> file. Also name the 4 named routes, and how the request is routed to the controller/action.</a></p></li>
<li><p><a name='q2'></a><a href="#a2">What is REST and how does it relate to the <code>resources</code> routes?</a></p></li>
<li><p><a name='q3'></a><a href="#a3">What&#39;s the major difference between model backed and non-model backed form helpers?</a></p></li>
<li><p><a name='q4'></a><a href="#a4">How does <code>form_for</code> know how to build the <code>&lt;form&gt;</code> element?</a></p></li>
<li><p><a name='q5'></a><a href="#a5">What&#39;s the general pattern we use in the actions that handle submission of model-backed forms (ie, the <code>create</code> and <code>update</code> actions)?</a></p></li>
<li><p><a name='q6'></a><a href="#a6">How exactly do Rails validations get triggered? Where are the errors saved? How do we show the validation messages on the user interface?</a></p></li>
<li><p><a name='q7'></a><a href="#a7">What are Rails helpers?</a></p></li>
<li><p><a name='q8'></a><a href="#a8">What are Rails partials?</a></p></li>
<li><p><a name='q9'></a><a href="#a9">When do we use partials vs helpers?</a></p></li>
<li><p><a name='q10'></a><a href="#a10">When do we use non-model backed forms?</a></p></li>
</ol>

<h3 id="my-answers:">MY ANSWERS:</h3>

<p><a name='a1'></a>
<strong>A1</strong>: Having <code>resources :dogs</code> in the block in the routes.rb file is going to give us the following routes</p>

<table><thead>
<tr>
<th>Prefix</th>
<th>Verb</th>
<th>URI Pattern</th>
<th>Controller#Action</th>
</tr>
</thead><tbody>
<tr>
<td>dogs</td>
<td>GET</td>
<td>/dogs(.:format)</td>
<td>dogs#index</td>
</tr>
<tr>
<td></td>
<td>POST</td>
<td>/dogs(.:format)</td>
<td>dogs#create</td>
</tr>
<tr>
<td>new_dog</td>
<td>GET</td>
<td>/dogs/new(.:format)</td>
<td>dogs#new</td>
</tr>
<tr>
<td>edit_dog</td>
<td>GET</td>
<td>/dogs/:id/edit(.:format)</td>
<td>dogs#edit</td>
</tr>
<tr>
<td>dog</td>
<td>GET</td>
<td>/dogs/:id(.:format)</td>
<td>dogs#show</td>
</tr>
<tr>
<td></td>
<td>PATCH</td>
<td>/dogs/:id(.:format)</td>
<td>dogs#update</td>
</tr>
<tr>
<td></td>
<td>PUT</td>
<td>/dogs/:id(.:format)</td>
<td>dogs#update</td>
</tr>
<tr>
<td></td>
<td>DELETE</td>
<td>/dogs/:id(.:format)</td>
<td>dogs#destroy</td>
</tr>
</tbody></table>

<p><a href="#q1">Back</a></p>

<p><a name='a2'></a>
<strong>A2</strong>: REST (<strong>RE</strong>presentational <strong>S</strong>tate <strong>T</strong>ransfer) is a way to maintain data persistence in <strong>stateless</strong> data-transfer protocol (which is HTTP in our case). The <code>resources</code> keyword in the routes.rb file creates the most used 7 routes (listed above) in a Rails application. These routes are RESTful because they conform to the <a href="http://en.wikipedia.org/wiki/Representational_state_transfer#Architectural_constraints">REST architectural constraints</a> for web application development. 
<a href="#q2">Back</a></p>

<p><a name='a3'></a>
<strong>A3</strong>: The major difference is a model-backed helper requires, and directly works on, a ActiveRecord Model object for creation of equivalent HTML tags. This is makes it very tightly integrated with the model object and it&#39;s attributes. A non-model backed helper is a more generic helper to create HTML tags and do not need any ActiveRecord Model object to work on.<br>
<a href="#q3">Back</a></p>

<p><a name='a4'></a>
<strong>A4</strong>: Because the <code>form_for</code> is a model-backed form helper, it takes an ActiveRecord Model object to create an HTML form for using the model object&#39;s real and virtual attributes.<br>
<a href="#q4">Back</a></p>

<p><a name='a5'></a>
<div><strong>A5</strong>: The general pattern we use in actions that handle model-backed form submission is:</div>
<ol>
  <li>Create/Update Model Object in Memory</li>
  <li>Try to save it in the database</li>
  <li>If the save succeeds, redirect to the relevant page (showing the saved item by itself or in a list)</li>
  <li>If the save fails, render the page that submitted the form again, with the error messages (stored on the in-memory object) displayed</li>
</ol>
The equivalent code for the <code>create</code> action of the Category controller would look like this:
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="k">def</span> <span class="nf">create</span>
</span><span class='line'>  <span class="vi">@category</span> <span class="o">=</span> <span class="no">Category</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:category</span><span class="p">)</span><span class="o">.</span><span class="n">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">))</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;if @category.save</span>
</span><span class='line'><span class="sr">    flash[:notice] = &amp;#39;New category created.&amp;#39;</span>
</span><span class='line'><span class="sr">    redirect_to categories_path</span>
</span><span class='line'><span class="sr">  else</span>
</span><span class='line'><span class="sr">    render :new</span>
</span><span class='line'><span class="sr">  end</span>
</span><span class='line'><span class="sr">end</span>
</span><span class='line'><span class="sr">&lt;code&gt;</span>
</span><span class='line'><span class="sr">Slightly different from the `create` action, the `update` action would like like this:</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;</span><span class="no">Ruby</span>
</span><span class='line'><span class="k">def</span> <span class="nf">update</span>
</span><span class='line'>  <span class="vi">@category</span> <span class="o">=</span> <span class="no">Category</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;if @category.update(params.require(:category).permit(:name))</span>
</span><span class='line'><span class="sr">    flash[:notice] = &amp;#39;Category updated.&amp;#39;</span>
</span><span class='line'><span class="sr">    redirect_to category_path(@category)</span>
</span><span class='line'><span class="sr">  else</span>
</span><span class='line'><span class="sr">    render :edit</span>
</span><span class='line'><span class="sr">  end</span>
</span><span class='line'><span class="sr">end</span>
</span></code></pre></td></tr></table></div></figure>
<a href="#q5">Back</a></p>

<p><a name='a6'></a>
<div><strong>A6</strong>:</div>
<ul class='no_extra_new_line'>
  <li>Model validations are triggered when the database is accessed for update, for example: the <code>save</code> or <code>create</code> methods are called on a model object</li>
  <li>f there are validation errors triggered during the above operation, they are saved on the model object itself which can be accessed by calling <code>#errors</code> on it</li>
  Note: model_obj.errors.full_messages can be used to retrieve an array of error messages
  <li>This object cab be saved in an instance variable of the controller class and then can be used in the rendered template to display errors as shown below</li>
</ul>
<code>Ruby
&lt;% if model_obj.errors.any? %&gt;
  &lt;div class=&#39;row&#39;&gt;
    &lt;div class=&#39;alert alert-error span8&#39;&gt;
      &lt;h5&gt;Please fix the errors below to submit successfully:&lt;/h5&gt;
      &lt;ol&gt;
        &lt;% model_obj.errors.full_messages.each do |msg| %&gt;
          &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;
        &lt;% end %&gt;
      &lt;/ol&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;% end %&gt;
</code>
<a href="#q6">Back</a></p>

<p><a name='a7'></a>
<strong>A7</strong>: Rails helpers are methods that can be defined to contain repetitive logic for the presentation layer (used by the view templates). These helper methods usually go in the <code>app\helpers\application_helper.rb</code> file under the Rails project folder.<br>
<a href="#q7">Back</a></p>

<p><a name='a8'></a>
<strong>A8</strong>: Rails partials are HTML snippets which need to be reused in many view templates with no or minimum modifications (that can be handled by arguments). Filenames for partials begin with an <code>_</code>, for example: <code>_errors.html.erb</code>. This partial can be used by calling the render method on it, as in <code>&lt;%= render &#39;shared/errors&#39;, model_obj: @post %&gt;</code> where <code>model_obj</code> is an argument variable name that will be used in the partial (refer to the HTML code in <a href="#a6">Answer 6</a> above).<br>
<a href="#q8">Back</a></p>

<p><a name='a9'></a>
<strong>A9</strong>: Partials should be preferred over helpers when too much HTML needs to be embedded. Helpers should be reserved more for the logic (parsing / reformating / calculations) than the presentation itself.<br>
<a href="#q9">Back</a></p>

<p><a name='a10'></a>
<strong>A10</strong>: Non-model backed form helpers should be used whenever user-input elements need to be generated for properties which are not the associated attributes of an ActiveRecord Model object.<br>
<a href="#q10">Back</a></p>

<div id="disqus_thread"></div>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ppjgithubio'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<p><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></p>
]]></content>
  </entry>
  
</feed>
